<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with shinytest • shinytest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with shinytest">
<meta property="og:description" content="shinytest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinytest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/shinytest.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ci.html">Using shinytest with continuous integration</a>
    </li>
    <li>
      <a href="../articles/faq.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/ide.html">Integration with RStudio IDE</a>
    </li>
    <li>
      <a href="../articles/in-depth.html">Testing in depth</a>
    </li>
    <li>
      <a href="../articles/package.html">Using shinytest with R packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/shinytest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shinytest_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with shinytest</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/shinytest/blob/HEAD/vignettes/shinytest.Rmd" class="external-link"><code>vignettes/shinytest.Rmd</code></a></small>
      <div class="hidden name"><code>shinytest.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-test-shiny-applications">Why test Shiny applications?<a class="anchor" aria-label="anchor" href="#why-test-shiny-applications"></a>
</h2>
<p>After you get your Shiny application to a state where it works, it’s often useful to have an automated system that checks that it continues to work as expected. There are many possible reasons for an application to stop working. These reasons include:</p>
<ul>
<li><p>An upgraded R package has different behavior. (This could include Shiny itself!)</p></li>
<li><p>You make modifications to your application.</p></li>
<li><p>An external data source stops working, or returns data in a changed format.</p></li>
</ul>
<p>One way to detect these problems is with manual testing – in other words, by having a person interact with the app in a browser – but this can be time-intensive, inconsistent, and imprecise. Having automated tests can alert you to these kinds of problems quickly and with almost zero effort, after the tests have been created.</p>
</div>
<div class="section level2">
<h2 id="how-testing-works-with-shinytest">How testing works with shinytest<a class="anchor" aria-label="anchor" href="#how-testing-works-with-shinytest"></a>
</h2>
<p>The <strong>shinytest</strong> package provides tools for creating and running automated tests on Shiny applications.</p>
<p>Shinytest uses snapshot-based testing strategy. The first time it runs a set of tests for an application, it performs some scripted interactions with the app and takes one or more snapshots of the application’s state. These snapshots are saved to disk so that future runs of the tests can compare their results to them.</p>
<p>To create tests, the easiest method is to use the <code><a href="../reference/recordTest.html">recordTest()</a></code> function. This launches the application in a web browser and records your interactions with the application. These interactions are saved in a .R file, and are run using the strategy described above.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Begin by installing shinytest from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"shinytest"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="recording-tests">Recording tests<a class="anchor" aria-label="anchor" href="#recording-tests"></a>
</h3>
<p>This is the general procedure for recording tests:</p>
<ul>
<li><p>Run <code><a href="../reference/recordTest.html">recordTest()</a></code> to launch the app in a test recorder.</p></li>
<li><p>Create the tests by interacting with the application and telling the recorder to snapshot the state at various points.</p></li>
<li>
<p>Quit the test recorder. When you do this, three things will happen:</p>
<ul>
<li><p>The test script will be saved in a .R file in a subdirectory of the application named <code>tests/</code>.</p></li>
<li><p>If you are running in the RStudio IDE, it will automatically open this file in the editor.</p></li>
<li><p>The test script will be run, and the snapshots will be saved in a subdirectory of the <code>tests/</code> directory.</p></li>
</ul>
</li>
</ul>
<p>To record tests, we first need an app. Here is a simple app that I’ve placed in <code>simple-app/app.R</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"What is your name?"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="st">"greet"</span>, <span class="st">"Greet"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">textOutput</a></span><span class="op">(</span><span class="st">"greeting"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">greet</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hello "</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/isolate.html" class="external-link">isolate</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>, <span class="st">"!"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>To test it, I now load shinytest, and call <code><a href="../reference/recordTest.html">recordTest()</a></code> with the path to my app:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/shinytest" class="external-link">shinytest</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/recordTest.html">recordTest</a></span><span class="op">(</span><span class="st">"simple-app/"</span><span class="op">)</span></span></code></pre></div>
<p>In a separate R process, this launches the Shiny application to be tested. We’ll refer to this as the <strong>target app</strong>. This also launches a special Shiny application in the current R process which displays the target app in an iframe and has some controls outside the iframe. We’ll refer to this as the <strong>recorder app</strong>. You will see something like this:</p>
<p><img src="screenshot-recorder-1.png"></p>
<p>On the left is the target app (in this case, the “Shiny Widgets Gallery”), and on the right is the recorder app (titled “Test event recorder”). Note that you may need to make the browser window wider because the recorder panel occupies some space.</p>
<p>The panel on the right displays some controls for the test recorder, as well as a list of <strong>Recorded events</strong>. As you interact with the target app – in other words, when you set inputs on the app – you will see those interactions recorded in the Recorded events list.</p>
<p>For testing a Shiny application, setting inputs is only one part. It’s also necessary to check that the application produces the correct outputs. This is accomplished by taking snapshots of the application’s state.</p>
<p>There are two ways to record output values. One way is to take a <strong>snapshot</strong> of the application’s state. This will record all input values, output values, and <em>exported</em> values (more on exported values later). To do this, click the “Take snapshot” button on the recorder app.</p>
<p>After modifying some inputs and taking a snapshot, it will look something like this:</p>
<p><img src="screenshot-recorder-2.png"></p>
<p>It is also possible to take a <em>target</em> snapshot. This is a snapshot of one or more specified output (instead of the default, which is to snapshot the entire application). To do this, hold down the Control (or Command) button on your keyboard and click on an output; it will snapshot just that one output.</p>
<p>When you are done recording a sequence of events, click on the “Save script and exit test event recorder” button. If you are in the RStudio IDE, it will open the test script in the <code>tests/</code> subdirectory of the application. In this case, the name of the script is <code>mytest.R</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ShinyDriver.html">ShinyDriver</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"../../"</span><span class="op">)</span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">snapshotInit</span><span class="op">(</span><span class="st">"mytest"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">setInputs</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Hadley"</span><span class="op">)</span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">setInputs</span><span class="op">(</span>greet <span class="op">=</span> <span class="st">"click"</span><span class="op">)</span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">snapshot</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">snapshot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"greeting"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-tests">Running tests<a class="anchor" aria-label="anchor" href="#running-tests"></a>
</h3>
<p>When you quit the test recorder, it will automatically run the test script. There are three separate components involved in running the tests:</p>
<ol style="list-style-type: decimal">
<li><p>First is the <strong>test driver</strong>. This is the R process that coordinates the testing and controls the web browser. When working on creating tests interactively, this is the R process that you use.</p></li>
<li><p>Next is the <strong>Shiny process</strong>, also known as the <strong>server</strong>. This is the R process that runs the target Shiny application.</p></li>
<li><p>Finally, there is the <strong>web browser</strong>, also known as the <strong>client</strong>, which connects to the server. This is a headless web browser – one which renders the web page internally, but doesn’t display the content to the screen (<a href="http://phantomjs.org/" class="external-link">PhantomJS</a>).</p></li>
</ol>
<p>When you exit the test recorder, it will by default automatically run the test script, and will print something like this:</p>
<pre><code>Saved test code to /path/to/app/tests/mytest.R
Running mytest.R
====== Comparing mytest ...
  No existing snapshots at mytest-expected/. This is a first run of tests.

Updating baseline snapshot at tests/mytest-expected
Renaming tests/mytest-current
      =&gt; tests/mytest-expected.</code></pre>
<p>Behind the scenes, it runs <code><a href="../reference/testApp.html">testApp()</a></code>. You can manually run the tests with this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testApp.html">testApp</a></span><span class="op">(</span><span class="st">"myshinyapp"</span>, <span class="st">"mytest"</span><span class="op">)</span></span></code></pre></div>
<p>This will play back the interactions and record snapshots, as specified in the test script. The very first time the tests are run, they will be saved in a subdirectory of the app called <code>tests/mytest-expected</code>. These are the expected results, and future test runs will be compared against them.</p>
<p>The directory will contain two files for each snapshot. For example:</p>
<pre><code>001.json
001.png</code></pre>
<p>The .json file is a JSON representation of the state of the application when <code>app$snapshot()</code> was called. The .png file is a screenshot of the application, which you can look at to inspect the state of the application.</p>
<p>The JSON file stores the state of all the input, output, and export values at the time of the snapshot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">"input"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="dt">"action"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="dt">"checkbox"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="dt">"checkGroup"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"1"</span><span class="ot">,</span> <span class="st">"2"</span><span class="ot">,</span> <span class="st">"3"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="dt">"date"</span><span class="fu">:</span> <span class="st">"2014-01-01"</span><span class="fu">,</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="dt">"dates"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"2014-01-01"</span><span class="ot">,</span> <span class="st">"2015-01-01"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="dt">"file"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="dt">"num"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="dt">"radio"</span><span class="fu">:</span> <span class="st">"1"</span><span class="fu">,</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="dt">"select"</span><span class="fu">:</span> <span class="st">"1"</span><span class="fu">,</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="dt">"slider1"</span><span class="fu">:</span> <span class="dv">50</span><span class="fu">,</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="dt">"slider2"</span><span class="fu">:</span> <span class="ot">[</span><span class="dv">25</span><span class="ot">,</span> <span class="dv">75</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="dt">"text"</span><span class="fu">:</span> <span class="st">"Enter text..."</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">},</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="dt">"output"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="dt">"actionOut"</span><span class="fu">:</span> <span class="st">"[1] 1</span><span class="ch">\n</span><span class="st">attr(,</span><span class="ch">\"</span><span class="st">class</span><span class="ch">\"</span><span class="st">)</span><span class="ch">\n</span><span class="st">[1] </span><span class="ch">\"</span><span class="st">integer</span><span class="ch">\"</span><span class="st">                </span><span class="ch">\"</span><span class="st">shinyActionButtonValue</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="dt">"checkboxOut"</span><span class="fu">:</span> <span class="st">"[1] TRUE"</span><span class="fu">,</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="dt">"checkGroupOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">1</span><span class="ch">\"</span><span class="st"> </span><span class="ch">\"</span><span class="st">2</span><span class="ch">\"</span><span class="st"> </span><span class="ch">\"</span><span class="st">3</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="dt">"dateOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">2014-01-01</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>    <span class="dt">"datesOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">2014-01-01</span><span class="ch">\"</span><span class="st"> </span><span class="ch">\"</span><span class="st">2015-01-01</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="dt">"fileOut"</span><span class="fu">:</span> <span class="st">"NULL"</span><span class="fu">,</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="dt">"numOut"</span><span class="fu">:</span> <span class="st">"[1] 1"</span><span class="fu">,</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="dt">"radioOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">1</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    <span class="dt">"selectOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">1</span><span class="ch">\"</span><span class="st">"</span><span class="fu">,</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>    <span class="dt">"slider1Out"</span><span class="fu">:</span> <span class="st">"[1] 50"</span><span class="fu">,</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>    <span class="dt">"slider2Out"</span><span class="fu">:</span> <span class="st">"[1] 25 75"</span><span class="fu">,</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>    <span class="dt">"textOut"</span><span class="fu">:</span> <span class="st">"[1] </span><span class="ch">\"</span><span class="st">Enter text...</span><span class="ch">\"</span><span class="st">"</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>  <span class="fu">},</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>  <span class="dt">"export"</span><span class="fu">:</span> <span class="fu">{}</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="fu">}</span></span></code></pre></div>
<p>If you are using a source control system (like git), you should check in the expected results.</p>
</div>
<div class="section level3">
<h3 id="subsequent-test-runs">Subsequent test runs<a class="anchor" aria-label="anchor" href="#subsequent-test-runs"></a>
</h3>
<p>After the initial test run, you can run the tests again in the future to check for changes in your application’s behavior. If there are no changes to the snapshots, you will just see something like this, with no additional output:</p>
<pre><code>&gt; testApp("path/to/app")
Running mytest.R
====== Comparing mytest ... Passed.</code></pre>
<p>The results are saved to <code>tests/mytest-current</code>, and compared against the saved results in <code>tests/mytest-expected</code>. If the results are exactly the same, then the test is considered successful. It will return to the console with no additional output, and delete the <code>tests/mytest-current</code> directory.</p>
<p>If there are any differences between the current and expected results, you’ll see output like this:</p>
<pre><code>Running mytest.R
====== Comparing mytest ...
  Differences detected between mytest-current/ and mytest-expected/:

    Name         Status
    001.json  != Files differ
    001.png   != Files differ
Would you like to view the differences between expected and current results [y/n]?</code></pre>
<p>If you press <code>y</code> and then Enter, it will open a Shiny application which shows the differences between the expected and current results. For screenshots, the differences will be highlighted in red. You can also choose different ways of viewing the differences in screenshots. It will look something like this:</p>
<p><img src="diffviewer.png"></p>
<p>After inspecting the changes, you can choose to update the expected results (that is, replace the old expected results with the new current results), or to just quit without updating.</p>
<p>You should update the results if the changes are expected. You should quit without updating if the changes are unexpected.</p>
<p>If you want to compare the results again in the future, without running <code><a href="../reference/testApp.html">testApp()</a></code>, you can run the following:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/snapshotCompare.html">snapshotCompare</a></span><span class="op">(</span><span class="st">"path/to/app/"</span>, <span class="st">"mytest"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-test-scripts">Multiple test scripts<a class="anchor" aria-label="anchor" href="#multiple-test-scripts"></a>
</h3>
<p>In the example above, we had a single test script, named <code>mytest.R</code>. If you want to have more than one set of tests for an application, you can record new tests, each with a different name. You can enter the name when recording your tests:</p>
<p><img src="screenshot-recorder-name.png" width="298"></p>
<p>When you run <code>testApp("path/to/app")</code>, it will run all the tests scripts in the application’s <code>tests/</code> directory.</p>
</div>
</div>
<div class="section level2">
<h2 id="interactive-r-markdown-documents">Interactive R markdown documents<a class="anchor" aria-label="anchor" href="#interactive-r-markdown-documents"></a>
</h2>
<p>Shinytest can be used with <a href="http://rmarkdown.rstudio.com/authoring_shiny.html" class="external-link">interactive R markdown documents</a> that use <code>runtime: shiny</code> (sometimes also referred to as Shiny documents). This includes those that use the <a href="http://rmarkdown.rstudio.com/flexdashboard/" class="external-link">flexdashboard</a> package.</p>
<p>Shiny documents have some differences compared to regular Shiny applications, and so the tests are slightly different. For an example of an interactive Rmd with tests, see <a href="https://github.com/rstudio/shinytest/tree/main/tests/testthat/recorded_tests/rmd" class="external-link">here</a>.</p>
<div class="section level3">
<h3 id="randomness">Randomness<a class="anchor" aria-label="anchor" href="#randomness"></a>
</h3>
<p>In a Shiny Rmd application, the UI of the application is created dynamically, using some randomly generated IDs. To make the results repeatable, you must set a random seed; otherwise the output will have slight differences in each run. See the section on <a href="in-depth.html#controlling-randomness">controlling randomness</a> for more information.</p>
</div>
<div class="section level3">
<h3 id="one--rmd-file-per-directory">One .Rmd file per directory<a class="anchor" aria-label="anchor" href="#one--rmd-file-per-directory"></a>
</h3>
<p>For testing Shiny documents, only one .Rmd file is allowed per directory. This is because of the way that the test directory is structured. (Note that if you name your Shiny document index.Rmd, then when deployed on Shiny Server, the URL can use the directory name, like <a href="http://mydomain.com/dirname/" class="external-link uri">http://mydomain.com/dirname/</a>, instead of <a href="http://mydomain.com/dirname/index.Rmd" class="external-link uri">http://mydomain.com/dirname/index.Rmd</a>. When deployed on RStudio Connect or Shinyapps.io, the filename is automatically not used in the URL.)</p>
</div>
<div class="section level3">
<h3 id="prerendered-shiny-documents">Prerendered Shiny documents<a class="anchor" aria-label="anchor" href="#prerendered-shiny-documents"></a>
</h3>
<p>Some Shiny documents use <a href="http://rmarkdown.rstudio.com/authoring_shiny_prerendered.html" class="external-link"><code>runtime: shiny_prerendered</code></a>, which helps speed up page loading time. Normally, the first time these applications are run, they will leave behind a generated .html file as well as a cache directory named myfile_data/.</p>
<p>You can remove these files by adding this to the end of your test script (assuming the name of your document is doc.Rmd):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/shiny_prerendered_clean.html" class="external-link">shiny_prerendered_clean</a></span><span class="op">(</span><span class="st">"../doc.Rmd"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can save the generated files, but then the tests will be run with the generated files, so the prerendering step will not be run for future tests.</p>
<p>For an example of a prerendered .Rmd and tests, see <a href="https://github.com/rstudio/shinytest/tree/main/tests/testthat/recorded_tests/rmd-prerendered" class="external-link">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="next">Next<a class="anchor" aria-label="anchor" href="#next"></a>
</h2>
<p>Learn more about shinytest with the <a href="in-depth.html">testing in depth</a> article.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Winston Chang, Gábor Csárdi, Hadley Wickham, Posit Software, PBC.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '7030758f1dfae4baea1a66de46029355',
    indexName: 'shinytest',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
